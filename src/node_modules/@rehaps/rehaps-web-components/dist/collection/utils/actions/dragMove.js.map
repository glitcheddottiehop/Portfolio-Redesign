{"version":3,"file":"dragMove.js","sourceRoot":"","sources":["../../../../src/utils/actions/dragMove.ts"],"names":[],"mappings":"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","sourcesContent":["import { DragState } from './../../interfaces/data/dragState';\nimport { ScrollPosition } from './../../interfaces/data/scrollPosition';\nexport class DragMove {\n  static DRAG_STATE_DELAY: number = 200;\n\n  private position: ScrollPosition = new ScrollPosition();\n  private state = new DragState();\n  private element: HTMLElement | null = null;\n  private initialCursorStyle: string = '';\n  private dragTimeout: NodeJS.Timeout | null = null;\n\n  public get dragging() {\n    return this.state.dragging && this.state.moving;\n  }\n\n  constructor(element: HTMLElement) {\n    this.init(element);\n  }\n\n  /**\n   * Initialize drag move for the given element\n   */\n  init(element: HTMLElement): void {\n    this.element = element;\n    this.initialCursorStyle = element.style.cursor || '';\n    this.element.addEventListener('mousedown', this.mouseDownHandler);\n  }\n\n  /**\n   * Start drag move for the given element if cursor is inside the element\n   */\n  mouseDownHandler = (event: MouseEvent) => {\n    if (event.composedPath().includes(this.element)) {\n      this.startDrag();\n      this.position = {\n        left: this.element.scrollLeft,\n        top: this.element.scrollTop,\n        x: event.clientX,\n        y: event.clientY\n      };\n\n      document.addEventListener('mousemove', this.mouseMoveHandler);\n      document.addEventListener('mouseup', this.mouseUpHandler);\n    }\n  }\n\n  /**\n   * Handle mouse movement if mouse down was triggered inside the element\n   */\n  mouseMoveHandler = (event: MouseEvent) => {\n    // How far the mouse has been moved\n    const dx = event.clientX - this.position.x;\n    const dy = event.clientY - this.position.y;\n\n    if (dx !== 0 || dy !== 0) {\n      this.state.moving = true;\n    }\n\n    // Scroll the element\n    this.element.scrollTop = this.position.top - dy;\n    this.element.scrollLeft = this.position.left - dx;\n  }\n\n  /**\n   * Stop drag move and unregister mouse move / up listeners\n   */\n  mouseUpHandler = () => {\n    document.removeEventListener('mousemove', this.mouseMoveHandler);\n    document.removeEventListener('mouseup', this.mouseUpHandler);\n\n    this.element.style.cursor = this.initialCursorStyle;\n\n    this.stopDrag();\n  }\n\n  /**\n   * Remove drag move event listener from element\n   */\n  destroy(): void {\n    this.element.removeEventListener('mouseDown', this.mouseDownHandler);\n  }\n\n  /**\n   * Start new drag timeout for state update\n   */\n  startDrag(): void {\n    this.stopDrag();\n    this.dragTimeout = setTimeout(() => {\n      this.state.dragging = true;\n    }, DragMove.DRAG_STATE_DELAY);\n  }\n\n  /**\n   * Set drag move state to false and remove drag state timeout if set\n   */\n  stopDrag(): void {\n    if (this.dragTimeout !== null) {\n      clearTimeout(this.dragTimeout);\n      this.dragTimeout = null;\n    }\n\n    // Delay dragging state change so instant click event is not triggered on mouse up\n    if (this.state.dragging || this.state.moving) {\n      setTimeout(() => {\n        this.state.dragging = false;\n        this.state.moving = false;\n      }, 1);\n    }\n  }\n}\n"]}