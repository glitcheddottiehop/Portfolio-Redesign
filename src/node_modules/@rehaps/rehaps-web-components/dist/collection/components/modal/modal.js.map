{"version":3,"file":"modal.js","sourceRoot":"","sources":["../../../../src/components/modal/modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  h,\n  Element,\n  State,\n  Prop,\n  Event,\n  EventEmitter,\n  Method,\n  Fragment,\n  FunctionalComponent,\n  Host,\n} from \"@stencil/core\";\nimport { RWCActionHelper } from \"../../utils/actions/rwcActionHelper\";\nimport CloseIcon from \"@material-design-icons/svg/round/close.svg\";\nimport { EventManager } from \"../../utils/actions/eventManager\";\nimport { IOpenable } from \"../../interfaces/actions/IOpenable\";\nimport { IClosable } from \"../../interfaces/actions/IClosable\";\nimport { IToggleable } from \"../../interfaces/actions/IToggleable\";\n\n/**\n *\n * @slot header The slot for the header content of the modal.\n * @slot footer The slot for the footer content of the modal.\n * @slot - Default - The default slot for the main content of the modal.\n */\n@Component({\n  tag: \"rwc-modal\",\n  styleUrl: \"modal.scss\",\n  shadow: true,\n})\nexport class RwcModal implements IOpenable, IClosable, IToggleable {\n  /**\n   * The reference to the currently open modal component.\n   */\n  static openModal: RwcModal = null;\n\n  /**\n   * The reference to the host element.\n   */\n  @Element() host: HTMLRwcModalElement;\n\n  /**\n   * The reference to the root element.\n   */\n  private rootElement?: HTMLDivElement;\n\n  /**\n   * The reference to the inner container of the modal.\n   */\n  private innerContainer?: HTMLDivElement;\n\n  /**\n   * Determines if the modal has content in the header slot.\n   */\n  private hasHeaderContent: boolean = false;\n\n  /**\n   * Determines if the modal has content in the footer slot.\n   */\n  private hasFooterContent: boolean = false;\n\n  /**\n   * Event manager used to manage component's event subscriptions.\n   */\n  public eventManager: EventManager = new EventManager();\n\n  /**\n   * List of the actions available for the component.\n   */\n  public actions: (\"open\" | \"close\" | \"toggle\")[] = [\"open\", \"close\", \"toggle\"];\n\n  /**\n   * The timeout callback of the modal animation.\n   */\n  private animationTimeout: NodeJS.Timeout = null;\n\n  /**\n   * Key used to bind action elements to the modal.\n   */\n  @Prop({ reflect: true })\n  rwcKey: string = RWCActionHelper.getDefaultComponentKey(\"modal\");\n\n  /**\n   * If content is longer than sidebar then scroll self instead of parent.\n   */\n  @Prop({ reflect: true }) innerScroll: boolean = false;\n\n  /**\n   * Sets rendering of divider after the header.\n   */\n  @Prop({ reflect: true }) renderHeaderDivider: boolean = true;\n\n  /**\n   * Sets rendering of divider before the footer.\n   */\n  @Prop({ reflect: true }) renderFooterDivider: boolean = true;\n\n  /**\n   * Sets rendering of close icon.\n   */\n  @Prop({ reflect: true }) renderCloseIcon: boolean = true;\n\n  /**\n   * Speed of the modal fade in/out animation.\n   */\n  @Prop() animationSpeed: number = 200;\n\n  /**\n   * The event called on completing the opening of the modal.\n   */\n  @Event({ eventName: \"modalOpen\" }) openEvent: EventEmitter<void>;\n\n  /**\n   * The event called on completing the closing of the modal.\n   */\n  @Event({ eventName: \"modalClose\" }) closeEvent: EventEmitter<void>;\n\n  /**\n   * The current open state of the modal.\n   */\n  @State() isOpen: boolean = false;\n\n  /**\n   * Get current opacity from style if set or from computed style otherwise.\n   */\n  get currentOpacity(): number {\n    return Number.parseFloat(\n      this.rootElement?.style.opacity ||\n        getComputedStyle(this.rootElement).opacity\n    );\n  }\n\n  /**\n   * Gets the animation duration from style variables in milliseconds.\n   */\n  get animationDuration(): number {\n    return Number.parseInt(\n      getComputedStyle(this.host).getPropertyValue(\"--modal-animation-duration\")\n    );\n  }\n\n  /**\n   * Initializes event listeners on insert into DOM.\n   */\n  connectedCallback(): void {\n    this.init();\n  }\n\n  /**\n   * Removes registered event listeners before removing from DOM.\n   */\n  disconnectedCallback(): void {\n    this.eventManager.clearEventListeners();\n  }\n\n  /**\n   * Called before each render call.\n   */\n  componentWillRender(): void {\n    this.hasHeaderContent = Boolean(this.host.querySelector('[slot=\"header\"]'));\n    this.hasFooterContent = Boolean(this.host.querySelector('[slot=\"footer\"]'));\n  }\n\n  /**\n   * Initializes toggle / close / open events.\n   */\n  @Method()\n  async init(): Promise<void> {\n    this.eventManager.clearEventListeners();\n    this.bindToggleActions();\n  }\n\n  /**\n   * Toggles sidebar's open state.\n   */\n  @Method()\n  async toggle(): Promise<void> {\n    if (this.isOpen) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * Opens sidebar.\n   */\n  @Method()\n  async open(): Promise<void> {\n    if (!this.isOpen) {\n      if (RwcModal.openModal !== null) {\n        await RwcModal.openModal.close();\n      }\n\n      clearTimeout(this.animationTimeout);\n\n      this.isOpen = true;\n\n      this.animationTimeout = setTimeout(() => {\n        RwcModal.openModal = this;\n        document.body.classList.add(\"modal-open\");\n        this.openEvent.emit();\n      }, this.animationDuration);\n    }\n  }\n\n  /**\n   * Closes the modal.\n   */\n  @Method()\n  async close(): Promise<void> {\n    if (this.isOpen) {\n      clearTimeout(this.animationTimeout);\n\n      this.isOpen = false;\n\n      setTimeout(() => {\n        if (RwcModal.openModal === this) {\n          RwcModal.openModal = null;\n          document.body.classList.remove(\"modal-open\");\n        }\n        this.closeEvent.emit();\n      }, this.animationDuration);\n    }\n  }\n\n  /**\n   * Bind toggle events to the elements matching this component's key.\n   */\n  bindToggleActions(): void {\n    RWCActionHelper.bindRWCActions(this, this.host, this.actions, this.rwcKey);\n  }\n\n  /**\n   * Handle falloff click (background area of modal window).\n   */\n  falloffClick(event: PointerEvent): void {\n    if (\n      !this.innerContainer.contains(event.target as HTMLElement) &&\n      !this.host.contains(event.target as HTMLElement)\n    ) {\n      this.close();\n    }\n  }\n\n  /**\n   * Get header html if header content is set.\n   */\n  private renderHeaderHtml(): string {\n    if (this.hasHeaderContent) {\n      return (\n        <Fragment>\n          <div class={{ header: true, flex: this.renderCloseIcon }}>\n            <div>\n              <slot name=\"header\"></slot>\n            </div>\n            {this.renderCloseIcon ? this.renderCloseIconHtml() : \"\"}\n          </div>\n          {this.renderHeaderDivider ? <div class=\"divider\"></div> : \"\"}\n        </Fragment>\n      );\n    } else if (this.renderCloseIcon) {\n      return <div class=\"header empty\">{this.renderCloseIconHtml()}</div>;\n    }\n    return \"\";\n  }\n\n  /**\n   * Renders the footer if footer content is set.\n   */\n  private renderFooterHtml(): FunctionalComponent {\n    if (this.hasFooterContent) {\n      return (\n        <Fragment>\n          {this.renderFooterDivider ? <div class=\"divider\"></div> : \"\"}\n          <div class=\"footer\">\n            <slot name=\"footer\"></slot>\n          </div>\n        </Fragment>\n      );\n    }\n    return <Fragment></Fragment>;\n  }\n\n  /**\n   * Renders the close icon if rendering of close icon is enabled.\n   */\n  private renderCloseIconHtml(): FunctionalComponent {\n    if (this.renderCloseIcon) {\n      return (\n        <Fragment>\n          <div class=\"close-wrapper\">\n            <div\n              class=\"close\"\n              onClick={() => this.close()}\n              innerHTML={CloseIcon}\n            ></div>\n          </div>\n        </Fragment>\n      );\n    }\n    return <Fragment></Fragment>;\n  }\n\n  /**\n   * Renders the component.\n   */\n  render(): FunctionalComponent {\n    return (\n      <Host>\n        <div\n          ref={(element: HTMLDivElement) => (this.rootElement = element)}\n          class={{\n            container: true,\n            open: this.isOpen,\n            \"inner-scroll\": this.innerScroll,\n          }}\n          onClick={(event: PointerEvent) => this.falloffClick(event)}\n        >\n          <div class=\"scroll-wrapper\">\n            <div class=\"inner-container-wrapper\">\n              <div\n                class=\"inner-container\"\n                ref={(element: HTMLDivElement) =>\n                  (this.innerContainer = element)\n                }\n              >\n                {this.renderHeaderHtml()}\n\n                <div class=\"content\">\n                  <slot></slot>\n                </div>\n\n                {this.renderFooterHtml()}\n              </div>\n            </div>\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n"]}